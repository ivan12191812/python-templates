# Template para manejo de archivos CSV import csv import pandas as pd ''' Esta plantilla contiene funciones comunes para el manejo de archivos CSV. Funciones incluidas: - read_csv_with_csv: Lee un CSV usando el mÃ³dulo csv (estÃ¡ndar) - read_csv_with_pandas: Lee un CSV usando pandas (recomendado para anÃ¡lisis) - write_csv_with_csv: Escribe un CSV usando el mÃ³dulo csv - write_csv_with_pandas: Escribe un CSV usando pandas ''' def read_csv_with_csv(filepath, delimiter=','): """Lee un archivo CSV usando el mÃ³dulo csv y retorna una lista de diccionarios.""" data = [] try: with open(filepath, 'r', newline='', encoding='utf-8') as csvfile: reader = csv.DictReader(csvfile, delimiter=delimiter) for row in reader: data.append(row) return data except Exception as e: print(f"Error al leer el archivo CSV: {e}") return None def read_csv_with_pandas(filepath, delimiter=','): """Lee un archivo CSV usando pandas y retorna un DataFrame.""" try: df = pd.read_csv(filepath, delimiter=delimiter) return df except Exception as e: print(f"Error al leer el archivo CSV con pandas: {e}") return None def write_csv_with_csv(data, filepath, fieldnames=None, delimiter=','): """Escribe una lista de diccionarios a un archivo CSV usando el mÃ³dulo csv.""" try: if not fieldnames and data: fieldnames = data[0].keys() with open(filepath, 'w', newline='', encoding='utf-8') as csvfile: writer = csv.DictWriter(csvfile, fieldnames=fieldnames, delimiter=delimiter) writer.writeheader() writer.writerows(data) return True except Exception as e: print(f"Error al escribir el archivo CSV: {e}") return False def write_csv_with_pandas(df, filepath, index=False, delimiter=','): """Escribe un DataFrame de pandas a un archivo CSV.""" try: df.to_csv(filepath, index=index, sep=delimiter) return True except Exception as e: print(f"Error al escribir el archivo CSV con pandas: {e}") return False # Ejemplo de uso if __name__ == "__main__": # Crear datos de ejemplo example_data = [ {"nombre": "Juan", "edad": 30, "ciudad": "Madrid"}, {"nombre": "Ana", "edad": 25, "ciudad": "Barcelona"}, {"nombre": "Carlos", "edad": 40, "ciudad": "Valencia"} ] # Escribir con csv write_csv_with_csv(example_data, "ejemplo_csv.csv") # Leer con csv data = read_csv_with_csv("ejemplo_csv.csv") print("Datos leÃ­dos con csv:", data) # Escribir y leer con pandas df = pd.DataFrame(example_data) write_csv_with_pandas(df, "ejemplo_pandas.csv") df_read = read_csv_with_pandas("ejemplo_pandas.csv") print("\nDatos leÃ­dos con pandas:\n", df_read)